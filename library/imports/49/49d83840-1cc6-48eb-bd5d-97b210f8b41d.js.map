{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\Shooter.js"],"names":["cc","Class","extends","Component","properties","shootingPosYThreshold","waitMssTimePerShot","laser","default","type","Node","onLoad","shooting","lastShot","Date","now","canvas","director","getScene","getChildByName","startShooting","self","stopShooting","touchPadShooting","eventManager","addListener","event","EventListener","TOUCH_ONE_BY_ONE","onTouchBegan","touch","touchLoc","getLocation","node","parent","convertToNodeSpaceAR","y","onTouchMoved","onTouchEnded","createLaser","instantiate","tempPos","position","active","zIndex","addChild","onDisable","getCollisionManager","enabled","enabledDebugDraw","inTimeRange","update","dt"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,+BAAuB,GADf;AAERC,4BAAoB,GAFZ;AAGRC,eAAO;AACHC,qBAAS,IADN;AAEHC,kBAAMT,GAAGU;AAFN;AAHC,KAHP;;AAYL;AACAC,YAAQ,kBAAY;AAChB,aAAKC,QAAL,GAAgB,KAAhB;AACA,aAAKC,QAAL,GAAgBC,KAAKC,GAAL,EAAhB;AACA,aAAKC,MAAL,GAAchB,GAAGiB,QAAH,CAAYC,QAAZ,GAAuBC,cAAvB,CAAsC,QAAtC,CAAd;AACA;AACH,KAlBI;;AAqBLC,mBAAe,uBAAUC,IAAV,EAAgB;AAC7B,aAAKT,QAAL,GAAgB,IAAhB;AACD,KAvBI;;AAyBLU,kBAAc,wBAAY;AACxB,aAAKV,QAAL,GAAgB,KAAhB;AACD,KA3BI;;AA6BLW,sBAAkB,4BAClB;AAAA;;AACEvB,WAAGwB,YAAH,CAAgBC,WAAhB,CAA4B;AACxBC,mBAAO1B,GAAG2B,aAAH,CAAiBC,gBADA;AAExBC,0BAAc,sBAACC,KAAD,EAAQJ,KAAR,EAAkB;AAC9B,oBAAIK,WAAWD,MAAME,WAAN,EAAf;AACA,oBAAI,MAAKC,IAAL,CAAUC,MAAV,CAAiBC,oBAAjB,CAAsCJ,QAAtC,EAAgDK,CAAhD,GAAoD,MAAK/B,qBAA7D,EAAoF,OAAO,IAAP;AACpF,sBAAKO,QAAL,GAAgB,IAAhB;AACA,uBAAO,IAAP;AACD,aAPuB;AAQxByB,0BAAc,sBAACP,KAAD,EAAQJ,KAAR,EAAkB;AAC9B,oBAAIK,WAAWD,MAAME,WAAN,EAAf;AACA,oBAAI,MAAKC,IAAL,CAAUC,MAAV,CAAiBC,oBAAjB,CAAsCJ,QAAtC,EAAgDK,CAAhD,GAAoD,MAAK/B,qBAA7D,EACA;AACE,0BAAKO,QAAL,GAAgB,KAAhB;AACA,2BAAO,KAAP;AACD;AACD,sBAAKA,QAAL,GAAgB,IAAhB;AACA,uBAAO,IAAP;AACD,aAjBuB;AAkBxB0B,0BAAc,sBAACR,KAAD,EAAQJ,KAAR,EAAkB;AAC9B,sBAAKd,QAAL,GAAgB,KAAhB;AACD;AApBuB,SAA5B,EAqBG,KAAKqB,IArBR;AAsBD,KArDI;;AAuDLM,iBAAa,uBACb;AACE,YAAIhC,QAAQP,GAAGwC,WAAH,CAAe,KAAKjC,KAApB,CAAZ;AACA,YAAIkC,UAAU,KAAKR,IAAL,CAAUC,MAAV,CAAiBQ,QAA/B;AACAD,gBAAQL,CAAR,IAAa,EAAb;AACA7B,cAAMmC,QAAN,GAAiBD,OAAjB;AACAlC,cAAMoC,MAAN,GAAe,IAAf;AACApC,cAAMqC,MAAN,GAAe,CAAC,CAAhB;AACA,aAAK5B,MAAL,CAAY6B,QAAZ,CAAqBtC,KAArB;AACA,eAAO,IAAP;AACD,KAjEI;;AAmELuC,eAAW,qBACX;AACI9C,WAAGiB,QAAH,CAAY8B,mBAAZ,GAAkCC,OAAlC,GAA4C,KAA5C;AACAhD,WAAGiB,QAAH,CAAY8B,mBAAZ,GAAkCE,gBAAlC,GAAqD,KAArD;AACH,KAvEI;;AAyELC,iBAAa,uBACb;AACE,eAASpC,KAAKC,GAAL,KAAa,KAAKF,QAAnB,GAA+B,KAAKP,kBAA5C;AACD,KA5EI;;AA8EL6C,YAAQ,gBAAUC,EAAV,EACR;AACE;AACA;AACA,YAAI,KAAKxC,QAAL,IAAiB,KAAKsC,WAAL,EAArB,EAAyC;AACvC,iBAAKrC,QAAL,GAAgBC,KAAKC,GAAL,EAAhB;AACA,iBAAKwB,WAAL;AACA,iBAAK3B,QAAL,GAAgB,KAAhB;AACD;AACF;AAvFI,CAAT","file":"unknown","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        shootingPosYThreshold: 100,\r\n        waitMssTimePerShot: 900,\r\n        laser: {\r\n            default: null,\r\n            type: cc.Node\r\n        }\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\n        this.shooting = false;\n        this.lastShot = Date.now();\r\n        this.canvas = cc.director.getScene().getChildByName('Canvas');\r\n        // this.touchPadShooting();\r\n    },\r\n\r\n\r\n    startShooting: function (self) {\r\n      this.shooting = true;\r\n    },\r\n\r\n    stopShooting: function () {\r\n      this.shooting = false;\r\n    },\r\n\r\n    touchPadShooting: function ()\r\n    {\r\n      cc.eventManager.addListener({\r\n          event: cc.EventListener.TOUCH_ONE_BY_ONE,\r\n          onTouchBegan: (touch, event) => {\r\n            var touchLoc = touch.getLocation();\r\n            if (this.node.parent.convertToNodeSpaceAR(touchLoc).y > this.shootingPosYThreshold) return true;\r\n            this.shooting = true;\r\n            return true;\r\n          },\r\n          onTouchMoved: (touch, event) => {\r\n            var touchLoc = touch.getLocation();\r\n            if (this.node.parent.convertToNodeSpaceAR(touchLoc).y > this.shootingPosYThreshold)\r\n            {\r\n              this.shooting = false;\r\n              return false;\r\n            }\r\n            this.shooting = true;\r\n            return true;\r\n          },\r\n          onTouchEnded: (touch, event) => {\r\n            this.shooting = false;\r\n          }\r\n      }, this.node);\r\n    },\r\n\r\n    createLaser: function ()\r\n    {\r\n      var laser = cc.instantiate(this.laser);\r\n      var tempPos = this.node.parent.position;\r\n      tempPos.y += 50;\r\n      laser.position = tempPos;\r\n      laser.active = true;\r\n      laser.zIndex = -1;\r\n      this.canvas.addChild(laser);\r\n      return true;\r\n    },\r\n\r\n    onDisable: function ()\r\n    {\r\n        cc.director.getCollisionManager().enabled = false;\r\n        cc.director.getCollisionManager().enabledDebugDraw = false;\r\n    },\r\n\n    inTimeRange: function ()\n    {\n      return ((Date.now() - this.lastShot) > this.waitMssTimePerShot);\n    },\n\r\n    update: function (dt)\r\n    {\r\n      // TO-DO , power up, multidisparo\r\n      // TO-DO , permitir disparar solo tras la muerte del laser previo\r\n      if (this.shooting && this.inTimeRange()) {\n        this.lastShot = Date.now();\n        this.createLaser();\n        this.shooting = false;\n      }\r\n    },\r\n});\r\n"]}